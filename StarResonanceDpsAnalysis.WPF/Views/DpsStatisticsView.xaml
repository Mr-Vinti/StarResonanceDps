<Window x:Class="StarResonanceDpsAnalysis.WPF.Views.DpsStatisticsView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:StarResonanceDpsAnalysis.WPF.Views"
        xmlns:svgc="https://github.com/dotnetprojects/SVGImage"
        xmlns:controls="clr-namespace:StarResonanceDpsAnalysis.WPF.Controls" 

        xmlns:wc="http://schemas.microsoft.com/netfx/2009/xaml/presentation"
        mc:Ignorable="d"
        Title="DpsStatisticsForm"
        Height="359" Width="320"
        Style="{StaticResource TransparentWindow}"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResize">
    <Window.Resources>
        <Style x:Key="TitleBar" TargetType="Border">
            <Setter Property="Background" Value="#CCBABABA"/>
            <Setter Property="VerticalAlignment" Value="Top"/>
            <Setter Property="Height" Value="26"/>
            <Setter Property="Panel.ZIndex" Value="1"/>
            <Setter Property="CornerRadius">
                <Setter.Value>
                    <CornerRadius TopLeft="{StaticResource MainCornerRadiusDouble}"
                                  TopRight="{StaticResource MainCornerRadiusDouble}"
                                  BottomLeft="0" BottomRight="0"/>
                </Setter.Value>
            </Setter>

            <EventSetter Event="MouseLeftButtonDown" Handler="TitleBar_MouseLeftButtonDown"/>
        </Style>

        <Style x:Key="StatisticTypeText" TargetType="TextBlock">
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="HorizontalAlignment" Value="Left"/>
            <Setter Property="Foreground" Value="#FFF"/>
            <Setter Property="FontFamily" Value="pack://application:,,,/Assets/Fonts/#HarmonyOS Sans SC"/>
            <Setter Property="Width" Value="51"/>
            <Setter Property="Margin" Value="19,0,0,0"/>
            <Setter Property="Text" Value="当前伤害"/>
        </Style>

        <Style x:Key="StatisticLRButton" TargetType="Button" BasedOn="{StaticResource IconButtonStyle}">
            <Setter Property="Width" Value="18"/>
            <Setter Property="Height" Value="16"/>
            <Setter Property="HorizontalAlignment" Value="Left"/>
            <Setter Property="VerticalAlignment" Value="Top"/>
            <Setter Property="Background" Value="{x:Null}"/>
            <Setter Property="BorderBrush" Value="{x:Null}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontFamily" Value="pack://application:,,,/Assets/Fonts/#iconfont"/>
            <Setter Property="FontSize" Value="15"/>
        </Style>

        <Style x:Key="StatisticSwitchButton" TargetType="Button" BasedOn="{StaticResource IconButtonStyle}">
            <Setter Property="Width" Value="18"/>
            <Setter Property="Height" Value="16"/>
            <Setter Property="HorizontalAlignment" Value="Left"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Background" Value="{x:Null}"/>
            <Setter Property="BorderBrush" Value="{x:Null}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontFamily" Value="pack://application:,,,/Assets/Fonts/#iconfont"/>
            <Setter Property="FontSize" Value="12"/>
        </Style>

        <Style x:Key="StatisticFuncButton" TargetType="Button" BasedOn="{StaticResource IconButtonStyle}">
            <Setter Property="Width" Value="18"/>
            <Setter Property="Height" Value="16"/>
            <Setter Property="HorizontalAlignment" Value="Right"/>
            <Setter Property="Background" Value="{x:Null}"/>
            <Setter Property="BorderBrush" Value="{x:Null}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontFamily" Value="pack://application:,,,/Assets/Fonts/#iconfont"/>
            <Setter Property="FontSize" Value="15"/>
        </Style>

        <Style x:Key="FooterContentBorder" TargetType="Border">
            <Setter Property="Background" Value="#CCBABABA"/>
            <Setter Property="VerticalAlignment" Value="Bottom"/>
            <Setter Property="Height" Value="25"/>
            <Setter Property="CornerRadius">
                <Setter.Value>
                    <CornerRadius TopLeft="0" TopRight="0"
                                  BottomLeft="{StaticResource MainCornerRadiusDouble}"
                                  BottomRight="{StaticResource MainCornerRadiusDouble}"/>
                </Setter.Value>
            </Setter>

            <EventSetter Event="MouseLeftButtonDown" Handler="TitleBar_MouseLeftButtonDown"/>
        </Style>

        <Style x:Key="FooterTextContent" TargetType="TextBlock">
            <Setter Property="Height" Value="16"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="FontFamily" Value="pack://application:,,,/Assets/Fonts/#HarmonyOS Sans SC"/>
            <Setter Property="Foreground" Value="#FFF"/>
        </Style>
    </Window.Resources>

    <!-- WindowChrome: 开启可拉伸边界 -->
    <wc:WindowChrome.WindowChrome>
        <wc:WindowChrome CaptionHeight="0"
                         ResizeBorderThickness="6"
                         GlassFrameThickness="0"
                         UseAeroCaptionButtons="False"/>
    </wc:WindowChrome.WindowChrome>

    <!-- 半透明/圆角交给内部 Border -->
    <Border x:Name="Root" Style="{StaticResource ShadowWindowBorder}" 
            Background="#99191919">
        <Grid Margin="-7,-8,-8,-8">

            <Border Style="{StaticResource TitleBar}" Margin="7,8,8,0">
                <!-- 顶部栏,Grid 一般不设置属性 -->
                <Grid>

                    <!--统计类型标注-->
                    <TextBlock x:Name="StatisticTypeLabel" Style="{StaticResource StatisticTypeText}" Grid.ColumnSpan="2" Margin="19,0,0,0"/>
                    <!--左侧按钮-->
                    <Button x:Name="LeftButton"
                            Style="{StaticResource StatisticLRButton}" 
                            Margin="1,6,0,0"
                            Content=""
                            Click="LeftButton_Click" VerticalAlignment="Center"/>
                    <!--右侧按钮-->
                    <Button x:Name="RightButton"
                            Style="{StaticResource StatisticLRButton}"
                            Margin="70,0,0,0"
                            Content=""
                            Click="RightButton_Click" VerticalAlignment="Center"/>
                    <!--切换按钮-->
                    <Button x:Name="SwitchButton"
                            Style="{StaticResource StatisticSwitchButton}"
                            Margin="90,0,0,0"
                            Content=""
                            ToolTip="切换为：全程 / 当前"
                            ToolTipService.InitialShowDelay="200"   
                            ToolTipService.ShowDuration="3000"
                            ToolTipService.Placement="Mouse" 
                            Click="SwitchButton_Click"/>

                    <!--刷新按钮-->
                    <Grid>
                        <!-- 你的按钮（触发器） -->
                        <Button x:Name="RefreshButton"
                        Style="{StaticResource StatisticFuncButton}"
                        Margin="0,5,50,5"
                        Content=""
                        Width="18"
                        MouseEnter="RefreshButton_MouseEnter"
                        MouseLeave ="RefreshButton_MouseLeave"
                        Click="RefreshButton_Click"/>
                        <!-- Popup 承载自定义 UserControl -->
                        <!--鼠标经过 显示测试-->
                        <Popup x:Name="SkillPopup"
               Placement="MousePoint"
               AllowsTransparency="True"
               StaysOpen="True">
                            <Border Background="#CC000000"
                    CornerRadius="8"
                    Padding="10">
                                <StackPanel>
                                    <!-- 顶部标题 -->
                                    <TextBlock Text="惊奇猫猫盒"
                               Foreground="White"
                               FontSize="16"
                               FontWeight="Bold"
                               Margin="0,0,0,6"/>

                                    <!-- 技能列表 -->
                                    <ItemsControl x:Name="SkillList">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <StackPanel Margin="0,8,0,0">
                                                    <!-- 技能名 -->
                                                    <TextBlock Text="{Binding SkillName}" 
                                               Foreground="Gold"
                                               FontWeight="Bold"/>
                                                    <!-- 总伤害 -->
                                                    <TextBlock>
                                        <Run Text="总伤害：" Foreground="White"/>
                                        <Run Text="{Binding TotalDamage}" Foreground="White"/>
                                                    </TextBlock>
                                                    <!-- 命中 / 暴击次数 / 平均伤害 -->
                                                    <TextBlock>
                                        <Run Text="命中：" Foreground="Orange"/>
                                        <Run Text="{Binding HitCount}" Foreground="White"/>
                                        <Run Text="    暴击次数：" Foreground="Orange"/>
                                        <Run Text="{Binding CritCount}" Foreground="White"/>
                                        <Run Text="    平均伤害：" Foreground="Orange"/>
                                        <Run Text="{Binding AvgDamage}" Foreground="White"/>
                                                    </TextBlock>
                                                </StackPanel>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </StackPanel>
                            </Border>
                        </Popup>
                    </Grid>

                    <!--设置按钮-->
                    <Button x:Name="SetButton"
                            Style="{StaticResource StatisticFuncButton}"
                            Margin="0,5,27,5"
                            Content="&#xE600;"
                            Click="SetButton_Click" Width="18">
                        <Button.ContextMenu>
                            <ContextMenu Style="{StaticResource ModernContextMenu}">
                                <!-- 只给 MenuItem 应用样式，Separator 不受影响 -->
                                <ContextMenu.Resources>
                                    <Style TargetType="MenuItem" BasedOn="{StaticResource ModernMenuItem}"/>
                                </ContextMenu.Resources>


                                <MenuItem  Style="{StaticResource CheckableMenuItem}" Header="统计BOSS" IsCheckable="True" IsChecked="False" />
                                <MenuItem  Header="个人模式"/>
                                <!--记录设置-->
                                <MenuItem Header="记录设置"  ItemContainerStyle="{StaticResource CheckableMenuItem}">
                                    <MenuItem Header="记录每一次"   Click="RecordSettingsMenuItem_Click"/>
                                    <MenuItem Header="不记录1分钟以下"  Click="RecordSettingsMenuItem_Click"/>
                                    <MenuItem Header="不记录2分钟以下"  Click="RecordSettingsMenuItem_Click"/>
                                </MenuItem>
                                <!--历史记录-->
                                <MenuItem x:Name="miHistory" ItemContainerStyle="{StaticResource CheckableMenuItem}" Header="历史记录" />
                                <!--打桩模式-->
                                <MenuItem Header="打桩模式"  ItemContainerStyle="{StaticResource CheckableMenuItem}">
                                    <MenuItem Header="个人打桩 " IsCheckable="True"  Click="PilingMenuItem_Click"/>
                                    <MenuItem Header="协会打桩" IsCheckable="True"  Click="PilingMenuItem_Click"/>
                                    <MenuItem Header="极限打桩" IsCheckable="True"  Click="PilingMenuItem_Click"/>
                                </MenuItem>
                                <MenuItem Header="技能日记"/>
                                <Separator/>
                                <MenuItem Header="退出" Click="ExitButton_Click"/>
                            </ContextMenu>
                        </Button.ContextMenu>

                    </Button>
                    <!--隐藏按钮-->
                    <Button x:Name="PullButton"
                            Style="{StaticResource StatisticFuncButton}"
                            Margin="0,5,4,5"
                            Content="" 
                            Click="PullButton_Click" RenderTransformOrigin="0.5,0.5" Width="18">
                        <Button.RenderTransform>
                            <TransformGroup>
                                <ScaleTransform/>
                                <SkewTransform/>
                                <RotateTransform Angle="0"/>
                                <TranslateTransform/>
                            </TransformGroup>
                        </Button.RenderTransform>
                    </Button>
                </Grid>
            </Border>

            <Border x:Name="ContentBorder" Style="{StaticResource FooterContentBorder}" Margin="7,0,8,8">
                <Grid>
                    <TextBlock Style="{StaticResource FooterTextContent}" 
                               Margin="6,0,0,0"
                               HorizontalAlignment="Left"
                               Width="28"
                               Text="[1]"/>
                    <TextBlock Style="{StaticResource FooterTextContent}" 
                               Margin="32,0,0,0"
                               HorizontalAlignment="Left"
                               Width="53"
                               Text="00:00"/>
                    <TextBlock Style="{StaticResource FooterTextContent}" 
                               Margin="0,0,4,0"
                               HorizontalAlignment="Right"
                               TextAlignment="Right"
                               Width="118"
                               Text="2.24万 DPS"/>
                </Grid>
            </Border>

        </Grid>
    </Border>


</Window>
