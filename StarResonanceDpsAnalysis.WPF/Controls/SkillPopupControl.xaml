<UserControl x:Class="StarResonanceDpsAnalysis.WPF.Controls.SkillPopupControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d"
             x:Name="root"
             d:DesignHeight="450" d:DesignWidth="800"
             Background="Transparent">
    <!-- 确保能接收鼠标 -->

    <UserControl.Resources>
        <SolidColorBrush x:Key="PanelBgBrush" Color="#CC0F1720"/>
        <SolidColorBrush x:Key="AccentYellow" Color="#FFD430"/>
        <ItemsPanelTemplate x:Key="StackItemsPanel">
            <StackPanel IsItemsHost="True" Orientation="Vertical"/>
        </ItemsPanelTemplate>
    </UserControl.Resources>

    <Border Background="{StaticResource PanelBgBrush}" CornerRadius="8" Padding="10"
            IsHitTestVisible="True">
        <Border.Effect>
            <DropShadowEffect BlurRadius="8" ShadowDepth="0" Opacity="0.55"/>
        </Border.Effect>

        <StackPanel>
            <TextBlock Text="{Binding Title, ElementName=root}"
                       Foreground="White" FontSize="18" FontWeight="Bold" Margin="0,0,0,8"/>

            <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="360" Focusable="False">
                <ItemsControl ItemsSource="{Binding ItemsSource, ElementName=root}"
                              ItemsPanel="{StaticResource StackItemsPanel}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border Padding="6" CornerRadius="6" Margin="0,6,0,6" Background="#00000000">
                                <StackPanel>
                                    <TextBlock FontSize="14" FontWeight="Bold" Foreground="{StaticResource AccentYellow}"
                                               Text="{Binding SkillName}" TextTrimming="CharacterEllipsis"/>
                                    <TextBlock Margin="0,4,0,0" Foreground="White">
                                        <Run Text="总伤害: "/>
                                        <Run Text="{Binding TotalDamage}" FontWeight="Bold"/>
                                    </TextBlock>
                                    <TextBlock Margin="0,4,0,0">
                                        <Run Text="命中: "/>
                                        <Run Text="{Binding HitCount}" Foreground="{StaticResource AccentYellow}" FontWeight="Bold"/>
                                        <Run Text="    暴击次数: "/>
                                        <Run Text="{Binding CritCount}" Foreground="{StaticResource AccentYellow}" FontWeight="Bold"/>
                                        <Run Text="    平均伤害: "/>
                                        <Run Text="{Binding AvgDamage}" Foreground="{StaticResource AccentYellow}" FontWeight="Bold"/>
                                    </TextBlock>
                                </StackPanel>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>
        </StackPanel>
    </Border>
</UserControl>
